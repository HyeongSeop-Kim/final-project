<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="moimsMapper">
    <select id="getNextSeq" resultType="_int">
        SELECT SQU_MOIM.NEXTVAL FROM DUAL
    </select>
    <select id="selectAll" resultType="somoimDTO">
        SELECT M.MOIM_ID AS moimId
             , M.MOIM_TITLE AS moimTitle
             , M.MOIM_INFO AS moimInfo
             , M.MOIM_LIMIT AS moimLimit
             , M.LOCATION_ID AS locationId
             , M.MOIM_IMAGE_PATH AS moimImagePath
             , L.LOCATION_NAME AS locationName
        FROM MOIM M
                 LEFT JOIN LOCATIONS L
                           ON M.LOCATION_ID = L.LOCATION_ID
    </select>
   <select id ="selectData" resultType="somoimDTO">
      SELECT  M.MOIM_ID  AS moimId
             ,M.MOIM_TITLE AS moimTitle
             ,M.MOIM_INFO  AS moimInfo
             ,M.MOIM_LIMIT  AS moimLimit
			 ,L.LOCATION_NAME AS locationName
             ,M.MOIM_IMAGE_PATH  AS moimImagePath
             ,M.LOCATION_ID  AS locationId
           FROM MOIM M
		   JOIN LOCATIONS L
			 ON M.LOCATION_ID = L.LOCATION_ID
          WHERE M.MOIM_ID = #{id}
    </select>
    <insert id="insertData" parameterType="somoimDTO"> <!-- 파일이름 , 네임 추가 -->
        INSERT INTO MOIM(MOIM_ID
                        , MOIM_TITLE
                        , MOIM_INFO
                        , MOIM_LIMIT
                        , LOCATION_ID
                        , MOIM_IMAGE_PATH
                        , CATEGORY_ID
                        , MOIM_CREATE_DATE)
        VALUES(SQU_MOIM.NEXTVAL
              , #{moimTitle}
              , #{moimInfo}
              , #{moimLimit}
              , #{locationId}
              , #{moimImagePath}
              , 1
              , SYSDATE)
    </insert>
    
        <update id="updataImage" parameterType="somoimDTO"> <!-- 파일이름 , 네임 추가 -->
        UPDATE MOIM 
        SET MOIM_IMAGE_PATH= #{moimImagePath}
      WHERE MOIM_ID = #{id};
    </update>
    
</mapper>

